<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>一键去水印</title>
  <meta name="referrer" content="never">
  <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <link rel="stylesheet" href="./index.css">
</head>
<body>
<br>
<br>
<h2 style="text-align:center">一键去水印</h2>
<div class="container" id="index">
  <div class="left">
    <textarea v-model="sourceText" rows="10" cols="77" placeholder="请粘贴抖音/小红书/快手/bilibili分享链接"></textarea>
    <input type="text" v-model="accessKey" placeholder="请输入授权码，特定ip段不需要填写" style="width:300px;">
    <span v-if="msg.show" v-bind:style="{color: msg.color}">{{msg.content}}</span>
    <button v-on:click="transform" type="button" style="float: right;width:70px;">
      <b>获取</b>
    </button>
  </div>
  <div class="right">
    <video id="myVideo" width="100%" height="100%" controls="controls">
      <source v-bind:src="realUrl" type="video/mp4"/>
    </video>
  </div>
  <br><br>
  <foot style="text-align:center;">
    <p>©2021 By Luis</p>
  </foot>
</div>

</body>
<script>
  var app = new Vue({
    el: '#index',
    data: {
      sourceText: "",
      realUrl: "",
      seen: false,
      accessKey: "",
      msg: {
        show: false,
        color: "red",
        content: ""
      }
    },
    methods: {
      transform: function () {
        var _this = this;
        var myVideo = document.getElementById("myVideo")
        axios.post(
                " /api/transform",
                {
                  pwd: _this.accessKey,
                  source_text: _this.sourceText,
                  media: 'douyin'
                }
        ).then(function (response) {
          _this.msg.color = "green"
          _this.msg.content = "获取成功！"
          myVideo.load();
          _this.realUrl = response.data.list[0];
          myVideo.pause();
        }).catch(function (error) {
          _this.msg.color = "red"
          _this.msg.content = "获取失败：" + error.response.data.message
          _this.msg.show = true
        });
      }
    }
  })
</script>
</html>
